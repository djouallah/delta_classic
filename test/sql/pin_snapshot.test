# name: test/sql/pin_snapshot.test
# description: Test that PIN_SNAPSHOT option is accepted and passed through
# group: [delta_classic]

require delta_classic

statement ok
INSTALL parquet;

statement ok
INSTALL delta;

statement ok
LOAD delta;

# Attach with PIN_SNAPSHOT option - should not error
statement ok
ATTACH 'test/data/single_schema' AS pindb (TYPE delta_classic, PIN_SNAPSHOT);

# Should still be able to query
query I
SELECT COUNT(*) FROM pindb.main.table_a;
----
3

statement ok
DETACH pindb;
